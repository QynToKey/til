## `UNIXコマンド`まとめ (つづき)

### vim（vi互換エディタ）

- `vim`: <br>Linux ディストリビューションに標準で搭載されている**エディター**

  #### 最低限知っておきたいコマンド

  ⚠️`vim`には`コマンドモード (normal mode)`と`編集モード (insert mode)`があって、うっかり変なキーを押すと`編集モード`のコマンドが起動するので注意

  | コマンド | 実行される操作 |
  | :---: | --- |
  | `vi ファイル名` | `vim`が**起動**する（指定したファイルが無いときは**新規作成**）<br>🤛 *このとき`コマンドモード`で起動する* |
  | `D` | 行末まで**削除** <br> ⚠️ *誤操作に注意!* |
  | `i` | `編集モード`が**起動**する *(Insert)*<br>🤛 *編集モードが起動すると画面下に`I`または`-- INSERT --`などと表示される* |
  | `Escキー` | `編集モード`から**抜ける**<br>🤛 *`I`や`-- INSERT --`の表示が消える* |
  | `:wq` | 行った編集を**保存して終了** *(Write, Quit)* <br>⚠️ `Esc`で`コマンドモード`に戻ってから行う |
  | `:q`  | `vim`を**終了** *(Quit)*<br>⚠️ *正常に終了されないときはアラートが表示される* |
  | `:q!` | 編集を保存せずに`vim`を**強制終了**<br>🤛 *とにかく何もせず`vim`を終了させたいときはコレ* |

  #### `編集モード`で入力する例（シェルスクリプトの場合）

  🤛 画面下に`I`または`-- INSERT --`などと表示されていることを確認してから以下を実行

  | コマンド | 実行される操作 |
  | :---: | --- |
  | `#!/bin/ash` | `#!/`: **シェバン** (プログラムを実行させるための接頭辞)<br>`bin/ash`: その環境で使っている**シェルのプログラム**を指定 |
  | `echo '文字列'` | 文字列を表示する <br>⚠️ *文字列(空白を含む)はシングルクォーテーション`''`で囲む |

  🤛 **シェルスクリプト**：ターミナルで打つUNIXコマンドを、ファイルに書いて自動実行できるようにしたもの


  #### ファイルを実行する

  - 実行例
    ```
    # 実行したいファイルのアクセス権限を確認
      $ ls -l
      total 4
      -rw-r--r-- 1 user group 31 Jan 28 13:46 FILE

    # 実行権限がなければユーザー`u`に`x`を付加
      $ chmod u+x FILE

    # 今いるディレクトリ内`./` のファイルを実行する
      $ ./FILE
      Hello World! // vim で入力した文字列が表示された
    ```
    🤛 *ファイルを呼ぶときにはディレクトリを指定する必要がある*

  #### 環境変数`PATH` について

  - **環境変数** `echo $PATH`: <br>環境変数`PATH`の中身`$`が出力される
    ```
    # 環境変数の出力例
      $ echo $PATH
      /usr/lib/node_modules/npm/node_modules/npm-lifecycle/node-gyp-bin:/node_modules/.bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
    ```
    🤛 *コロン`:`で区切られて、ディレクトリが登録されている*
    🤛 *この`$PATH`に「実行したいファイルのあるディレクトリ」を登録すれば、どこからでもそのファイルを実行できるようになる*

  - `PATH`に「今いるディレクトリ」を追加する操作例
    ```
    # 「今いるディレクトリ」を確認
      $ pwd
      /home/DIRECTORY

    # または、実行したいファイルを「呼び出しているディレクトリ」を確認
      $ which FILE
      /home/DIRECTORY/FILE

    # 「今いるディレクトリ」を`$PATH`の先頭に加える
      $ export PATH=/home/DIRECTORY:$PATH

    # ディレクトリを指定しなくてもファイルを実行できる
      $ FILE
      Hello World!
    ```
    - `which ファイル名`: 実行されるファイルの**フルパス**を表示
    - `export`: 環境変数を設定するための命令 <br>🤛 *上の操作例は「`PATH`という名前で、このディレクトリと`$PATH`を繋げなさい」という意味* <br>⚠️ *尚、設定した`$PATH`はログアウトするとリセットされる*


### リダイレクション

  #### コマンドの実行結果をファイルに保存する

  - `echo '文字列' > ファイル名`: <br>`''`の中の**文字列**を、指定したファイル内に**上書き保存**する（指定したファイルが無いときはファイルごと新規作成）
  - `echo '文字列' >> ファイル名`: <br>`''`の中の**文字列**を、指定したファイルの**末尾に追記**する

  #### ファイルの中身をコマンドへ流し込む

  - `シェルコマンド < ファイル名`: <br>ファイルの中身が**シェルコマンド**なら、その環境でシェルとして使っているコマンドへ `<` を使って渡すことができる
  - `シェルコマンド < ファイル名 > 実行結果を保存するファイル名`: <br>さらに、**コマンドの実行結果**を、指定したファイルへ`>`で渡せば**保存**できる


### パイプ

  #### コマンドの実行結果を他のコマンドへ渡す

  - `実行結果を出すコマンド | 実行結果を受け取るコマンド`: <br>コマンドとコマンドを`|`で繋ぐ <br>🤛 *左のコマンドの標準出力が、右のコマンドの標準入力に渡される*

  ```
  # 実行例（任意のディレクトリの詳細リストから、指定の文字列が含まれる行を検索）
    $ ls -l /etc/ | grep 'sudo'

  # さらにパイプを組み合わせて「行数」を取得
    $ ls -l /etc/ | grep 'sudo' | wc -l

  # リダイレクションと組み合わせて、結果をファイルへ保存
    $ ls -l /etc/ | grep 'sudo' | wc -l > result.txt
  ```
  🤛 *パイプは、他のパイプやリダイレクションと組み合わせることができる*


### 複雑な操作を一気に実行する

  #### ブレース展開 `{}`
  ```
  # 波括弧(ブレース)内で要素をカンマ区切りで入力する
    $ echo {a,b,c}
    a b c
  ```
  ⚠️ *カンマの後に空白を入れてしまうと展開されない*

  ```
  # 連続する値を`..`で渡して組み合わせる
    $ echo {1..3}{a..c}
    1a 1b 1c 2a 2b 2c 3a 3b 3c
  ```

  #### 複数のコマンドを連続して実行する

  - `1つめのコマンド && 2つめのコマンド`: <br>1つめのコマンド操作が成功したら、次のコマンドを実行する
  ```
  # 実行例（ディレクトリが生成されたら → そのディレクトリへ移動）
    $ mkdir test && cd test
  ```

  - `ブレース展開`と組み合わせて、複数のディレクトリを一気に作成
  ```
  # 番号を振って同じ名前のディレクトリを複数作成
    $ mkdir app{1..5}
    $ ls
    app1  app2  app3  app4  app5
  ```

  ```
  # それぞれのディレクトリに、拡張子を添えたファイルを作成
    $ touch app{1..3}/test{1..3}{.jpg,.png,.gif}
    $ ls app2
    test1.gif  test1.png  test2.jpg  test3.gif  test3.png
  ```

  ```
  # それぞれのディレクトリから、指定した拡張子のファイルを削除
    $ rm app{1..3}/test{1..3}{.jpg,.gif}
    $ ls app2
    test1.png  test2.png  test3.png
  ```


### ファイルやディレクトリを検索する

- `find ディレクトリ -name ファイル名`: <br>検索範囲となるディレクトリを指定 + `-name オプション`で検索したいファイル名を指定
  🤛 *ファイル名は`ワイルドカード`も使用できる*

- `-type f`: **ファイル**のみを検索対象にするとき
- `-type d`: **ディレクトリ**のみを検索対象にするとき
